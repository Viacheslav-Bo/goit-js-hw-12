{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/img/icons.svg","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function getImagesByQuery(query, page) {\n  const result = await axios.get('https://pixabay.com/api/', {\n    params: {\n      key: '53154523-05709ccc1510dd918919f2375',\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 15,\n      page: page,\n    },\n  });\n  return result.data;\n}\n\n// У файлі pixabay-api.js зберігай функції для виконання HTTP-запитів:\n// getImagesByQuery(query, page). Ця функція повинна приймати два параметри\n// query (пошукове слово, яке є рядком) та page (номер сторінки, яка є числом),\n//  здійснювати HTTP-запит і повертати значення властивості data з отриманої відповіді.\n// Pixabay API підтримує пагінацію та надає параметри page і per_page.\n// Зроби так, щоб у кожній відповіді при пошуку зображень приходило 15 об'єктів\n// (за замовчуванням 20).\n// Початкове значення параметра page повинно бути 1.\n// З кожним наступним запитом його необхідно збільшити на 1.\n// У разі пошуку за новим ключовим словом значення page потрібно повернути до початкового,\n// оскільки буде пагінація для нової колекції зображень.\n","export default \"__VITE_ASSET__CMaiXz4u__\"","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport sprite from '../img/icons.svg';\n\nconst loader = document.querySelector('.loader');\nconst gallery = document.querySelector('.gallery');\nconst btnLoadMore = document.querySelector('.js-load-more');\n\n// ===========================================================\n// БІБЛІОТЕКА lightbox\nlet lightbox = new SimpleLightbox('.gallery-link', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\n// ===========================================================\n// СТВОРЕННЯ РОЗМІТКИ\nexport function createGallery(images) {\n  return images\n    .map(function (img) {\n      const {\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      } = img;\n      return `<li class=\"gallery-item\">\n            <div class=\"gallery-img-container\">\n            <a class=\"gallery-link\" href=\"${largeImageURL}\">\n              <img class=\"image\" src=\"${webformatURL}\" alt=\"${tags}\" data-source=\"${largeImageURL}\"  /></a>\n            </div>\n            <div class=\"desc-container\">\n              <ul class=\"desc-list\">\n              <li class=\"icons\"><svg class=\"icon\" width=\"24\" height=\"24\">\n            <use href=\"${sprite}#icon-like\"></use>\n          </svg><span>${likes}</span></li>\n              <li class=\"icons\"><svg class=\"icon\" width=\"24\" height=\"24\">\n            <use href=\"${sprite}#icon-views\"></use>\n          </svg><span>${views}</span></li>\n              <li class=\"icons\"><svg class=\"icon\" width=\"24\" height=\"24\">\n            <use href=\"${sprite}#icon-comments\"></use>\n          </svg><span>${comments}</span></li>\n              <li class=\"icons\"><svg class=\"icon\" width=\"24\" height=\"24\">\n            <use href=\"${sprite}#icon-downloads\"></use>\n          </svg><span>${downloads}</span></li>\n              </ul>\n            </div>\n          </li>`;\n    })\n    .join('');\n}\n// ===========================================================\n// ВТАВКА РОЗМІТКИ В DOM\nexport function makeMarkup(res) {\n  if (!res.hits.length) {\n    iziToast.show({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      position: 'topRight',\n      backgroundColor: 'rgb(255, 215, 163)',\n    });\n    return;\n  }\n\n  const markup = createGallery(res.hits);\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  lightbox.refresh();\n}\n// ===========================================================\n// ДОДАТКОВІ ФУНКЦІЇ\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n\nexport function showLoader() {\n  loader.classList.add('is-shown');\n}\n\nexport function hideLoader() {\n  loader.classList.remove('is-shown');\n}\n\nexport function showLoadMoreButton() {\n  btnLoadMore.classList.add('btn-is-shown');\n}\n\nexport function hideLoadMoreButton() {\n  btnLoadMore.classList.remove('btn-is-shown');\n}\n","import { getImagesByQuery } from './js/pixabay-api.js';\nimport {\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  makeMarkup,\n} from './js/render-functions.js';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\n// ===================================================================\n// БАЗА\nconst form = document.querySelector('.form');\nconst submitBtn = document.querySelector('button[type=submit]');\nconst input = document.querySelector('input[name=\"search-text\"]');\nconst btnLoadMore = document.querySelector('.js-load-more');\n\n// ===================================================================\n// ПОЧАТКОВІ ЗНАЧЕННЯ\nlet searchWord;\nlet page = 1;\nlet total_pages = 0;\nconst perPage = 15;\nsubmitBtn.disabled = true;\n\n// ===================================================================\n// ПОДІЯ інпут\ninput.addEventListener('input', evt => {\n  submitBtn.disabled = evt.target.value.trim() === '';\n});\n// ===================================================================\n// СКРОЛ\nfunction scroll() {\n  const lastItem = document.querySelector('.gallery .gallery-item:last-child');\n  if (!lastItem) return;\n  window.scrollBy({\n    top: lastItem.getBoundingClientRect().height * 2,\n    behavior: 'smooth',\n  });\n}\n// ===================================================================\n// ФУНКЦІЯ IZITOAST\nfunction notification(message) {\n  iziToast.show({\n    message: message,\n    position: 'topRight',\n    backgroundColor: 'rgb(255, 215, 163)',\n  });\n}\n\n// ===================================================================\n// ПОДІЯ CLICK LOADMORE\nbtnLoadMore.addEventListener('click', async evt => {\n  showLoader();\n  try {\n    page += 1;\n    const res = await getImagesByQuery(searchWord, page);\n\n    total_pages = Math.ceil(res.totalHits / perPage);\n    btnLoadMore.textContent = `Page: ${page} of ${total_pages}`;\n\n    makeMarkup(res);\n\n    if (page >= total_pages) {\n      hideLoadMoreButton();\n      notification(\n        `We're sorry, but you've reached the end of search results. Total images found: ${res.totalHits}.`\n      );\n    }\n\n    scroll();\n  } catch (error) {\n    console.log('error', error);\n  } finally {\n    hideLoader();\n  }\n});\n\n// ===================================================================\n// ПОДІЯ сабміт\nform.addEventListener('submit', async evt => {\n  btnLoadMore.textContent = 'Load more';\n  hideLoadMoreButton();\n  showLoader();\n  try {\n    page = 1;\n    evt.preventDefault();\n    clearGallery();\n\n    searchWord = document\n      .querySelector('input[name=\"search-text\"]')\n      .value.trim();\n\n    if (!searchWord) {\n      return;\n    }\n\n    const res = await getImagesByQuery(searchWord, page);\n\n    makeMarkup(res);\n\n    if (res.totalHits > perPage) {\n      showLoadMoreButton();\n    } else if (res.hits.length < perPage && res.hits.length !== 0) {\n      hideLoadMoreButton();\n      notification(\n        `We're sorry, but you've reached the end of search results. Total images found: ${res.totalHits}.`\n      );\n    }\n\n    form.reset();\n    submitBtn.disabled = true;\n  } catch (error) {\n    console.log(error);\n    notification(`Oops! Something went wrong. Please try again later.`);\n  } finally {\n    hideLoader();\n  }\n});\n\n// Відсутнє повідомлення про помилку, якщо не знайдено зображень: у коді не передбачено перевірку\n// цієї ситуації та відображення помилки через iziToast. User Flow не містить повідомлення для користувача,\n// якщо не повернуто результатів (res.hits.length === 0).\n\n// Логіка скролінгу (scroll функція) імпортується та використовується напряму. Відповідно до специфікації,\n// уся логіка скролінгу має бути реалізована у головному файлі; лише допоміжна логіка скролінгу дозволена\n// поза межами головного файлу.\n\n// Рендеринг галереї (makeMarkup) може бути неправильно реалізований щодо ініціалізації SimpleLightbox:\n// якщо lightbox ініціалізується поза логікою рендерингу, це не відповідає вимозі повної інкапсуляції\n// у модулі рендерингу (не можу перевірити за цим фрагментом, але позначаю як потенційну проблему,\n// оскільки скролінг не імплементований локально).\n\n// Обробка помилок не показує ніяких сповіщень користувачеві; помилки лише логуються у консоль.\n// Немає зворотного зв’язку у разі невдачі запиту.\n\n// ==================================================================================================\n// при сабміті форми тобі необхідно зберігати те, що ввів користувач у глобальну змінну.\n// Поки в галерії нема зображень, кнопка повинна бути прихована.\n// Після того як у галереї з'являються зображення, кнопка з'являється в інтерфейсі під галереєю.\n// При повторному сабміті форми кнопка спочатку ховається, а після отримання результатів\n// запиту знову відображається за потреби.\n\n// У відповіді бекенд повертає властивість totalHits — загальна кількість зображень,\n// які відповідають критерію пошуку (для безкоштовного акаунту). Якщо користувач дійшов\n// до кінця колекції, ховай кнопку Load more і виводь повідомлення з наступним текстом.\n// We're sorry, but you've reached the end of search results.\n\n// При кожному новому сабміті форми номер сторінки скидається до дефолтного 1 і результати\n// попередніх запитів зникають\n\n// Зверни увагу, що кінець колекції може бути і на 1й сторінці, і на подальших.\n\n// Коли користувач отримує результати за максимально можливою сторінкою для конкретного пошукового\n// слова, тобто вже немає чого підвантажувати, кнопка Load more зникає і з’являється відповідне\n// повідомлення\n\n// Перенеси індикатор завантаження під кнопку завантаження додаткових зображень.\n\n// Після додавання нових елементів до списку зображень на екземплярі SimpleLightbox викликається\n// метод refresh()\n\n// логіку прокручування сторінки (scroll) робимо саме в цьому файлі.\n// Зроби плавне прокручування сторінки після запиту і відтворення кожної наступної групи зображень.\n// Для цього отримай у коді висоту однієї карточки галереї, використовуючи функцію\n// getBoundingClientRect. Після цього використовуй метод window.scrollBy для прокрутки\n// сторінки на дві висоти карточки галереї.\n"],"names":["getImagesByQuery","query","page","axios","sprite","loader","gallery","btnLoadMore","lightbox","SimpleLightbox","createGallery","images","img","webformatURL","largeImageURL","tags","likes","views","comments","downloads","makeMarkup","res","iziToast","markup","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","submitBtn","input","searchWord","total_pages","perPage","evt","scroll","lastItem","notification","message","error"],"mappings":"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"}